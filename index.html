
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIBS AI PathFinder</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    <!-- Google Fonts for Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Chat Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- PDF.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: white;
            color: #333;
            line-height: 1.6;
        }
        /* Header and Navigation Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            z-index: 1000;
            position: relative;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 60px;
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .logo {
            height: 40px;
            width: auto;
            max-width: 160px;
            transition: transform 0.3s ease;
        }
        .logo:hover {
            transform: scale(1.05);
        }
        /* Navigation Styles - Centered */
        nav {
            display: flex;
            align-items: center;
            margin: 0 auto;
        }
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
            margin: 0;
            padding: 0;
            align-items: center;
        }
        .nav-menu li {
            position: relative;
        }
        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            font-size: 15px;
            padding: 8px 0;
            transition: color 0.3s ease;
            position: relative;
            text-transform: capitalize;
        }
        .nav-menu a:hover {
            color: #20409a;
        }
        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #20409a;
            transition: width 0.3s ease;
        }
        .nav-menu a:hover::after {
            width: 100%;
        }
        /* Full-screen image section with animated text */
        .hero-section {
            width: 100%;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        .hero-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.3));
            display: flex;
            align-items: center;
            padding-left: 10%;
            pointer-events: none;
        }
        .animated-text {
            color: white;
            text-align: left;
            max-width: 600px;
        }
        .text-line {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 15px;
            opacity: 0;
            transform: translateY(20px);
            animation: textAppear 0.8s ease forwards;
            line-height: 1.2;
        }
        .text-line:nth-child(2) {
            font-size: 1.8rem;
            font-weight: 400;
            animation-delay: 1.5s;
            margin-bottom: 10px;
        }
        .text-line:nth-child(3) {
            font-size: 1.8rem;
            font-weight: 400;
            animation-delay: 3s;
            margin-bottom: 10px;
        }
        .text-line:nth-child(4) {
            font-size: 1.8rem;
            font-weight: 400;
            animation-delay: 4.5s;
            margin-bottom: 25px;
        }
        .hero-cta {
            opacity: 0;
            transform: translateY(20px);
            animation: textAppear 0.8s ease forwards;
            animation-delay: 6s;
            pointer-events: auto;
        }
        @keyframes textAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Updated CTA Button Style - Rectangular with curved corners */
        .cta-button {
            display: inline-block;
            background-color: #20409a;
            color: white;
            padding: 12px 32px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(32, 64, 154, 0.2);
            min-width: 180px;
            text-align: center;
        }
        .cta-button:hover {
            background-color: #1a357f;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(32, 64, 154, 0.3);
        }
        /* Content Section */
        .content-section {
            padding: 50px 0;
            text-align: center;
            background-color: white;
            position: relative;
        }
        .content-section h1 {
            font-size: 2.2rem;
            margin-bottom: 20px;
            color: #1a1a1a;
            font-weight: 700;
            position: relative;
            display: inline-block;
        }
        .content-section h1 .colored-dot {
            color: #20409a;
        }
        .content-section p {
            font-size: 1.05rem;
            max-width: 800px;
            margin: 0 auto 25px;
            color: #555;
            text-align: center;
        }
        /* Colored text for GIBS acronym */
        .gibs-acronym {
            color: #20409a;
            font-weight: 600;
        }
        /* About section specific styles */
        #about {
            position: relative;
            overflow: hidden;
            background-color: #f8f9fa;
        }
        .gradient-corner-right {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle at bottom right, rgba(32, 64, 154, 0.15), rgba(32, 64, 154, 0.05) 40%, transparent 70%);
            pointer-events: none;
            z-index: 1;
        }
        /* GIBS-AI section gradient */
        #gibs-ai {
            position: relative;
            overflow: hidden;
            margin-bottom: 0;
        }
        .gradient-corner-left {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle at bottom left, rgba(32, 64, 154, 0.15), rgba(32, 64, 154, 0.05) 40%, transparent 70%);
            pointer-events: none;
            z-index: 1;
        }
        .section-content {
            position: relative;
            z-index: 2;
        }
        /* Footer Styles */
        footer {
            background-color: #f8f9fa;
            padding: 25px 0;
            text-align: center;
            margin-top: 0;
            border-top: 1px solid #eaeaea;
        }
        footer p {
            color: #666;
            font-size: 13px;
        }
        /* Cookie Consent Banner */
        .cookie-consent {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            padding: 20px;
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            transform: translateY(100%);
            transition: transform 0.4s ease;
        }
        .cookie-consent.show {
            transform: translateY(0);
        }
        .cookie-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }
        .cookie-text {
            flex: 1;
            min-width: 300px;
        }
        .cookie-text p {
            font-size: 14px;
            color: #555;
            margin: 0;
        }
        .cookie-text a {
            color: #20409a;
            text-decoration: none;
            font-weight: 500;
        }
        .cookie-text a:hover {
            text-decoration: underline;
        }
        .cookie-buttons {
            display: flex;
            gap: 10px;
        }
        .cookie-btn {
            padding: 10px 24px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        .cookie-btn.accept {
            background-color: #20409a;
            color: white;
        }
        .cookie-btn.accept:hover {
            background-color: #1a357f;
            transform: translateY(-2px);
        }
        .cookie-btn.decline {
            background-color: #f0f0f0;
            color: #555;
        }
        .cookie-btn.decline:hover {
            background-color: #e0e0e0;
        }
        /* Floating Chat Icon */
        .chat-icon {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 60px;
            height: 60px;
            background-color: #20409a;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(32, 64, 154, 0.3);
            cursor: pointer;
            z-index: 999;
            transition: all 0.3s ease;
            animation: float 3s ease-in-out infinite;
        }
        .chat-icon:hover {
            background-color: #1a357f;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(32, 64, 154, 0.4);
        }
        .chat-icon i {
            color: white;
            font-size: 24px;
        }
        .chat-tooltip {
            position: absolute;
            bottom: 70px;
            right: 0;
            background-color: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
            font-size: 14px;
            color: #333;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            transform: translateY(10px);
        }
        .chat-tooltip::after {
            content: '';
            position: absolute;
            bottom: -8px;
            right: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid white;
        }
        .chat-icon:hover .chat-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        /* Chat Modal Styles - IMPROVED */
        .chat-modal {
            display: none;
            position: fixed;
            bottom: 90px;
            right: 25px;
            width: 400px;
            height: 550px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            z-index: 1000;
            flex-direction: column;
            border: 1px solid #eaeaea;
        }
        @media (max-width: 768px) {
            .chat-modal {
                width: 90%;
                right: 5%;
                bottom: 80px;
                height: 70vh;
                max-height: 500px;
            }
        }
        .chat-header {
            background: #20409a;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chat-header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chat-profile {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .chat-profile i {
            color: #20409a;
            font-size: 18px;
        }
        .chat-header h2 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }
        .close-chat {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }
        .close-chat:hover {
            background: rgba(255,255,255,0.2);
        }
        /* Delete chat button */
        .delete-chat {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
            margin-left: 10px;
        }
        .delete-chat:hover {
            background: rgba(255, 50, 50, 0.3);
        }
        .chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: #fafafa;
        }
        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.5;
            word-wrap: break-word;
            position: relative;
        }
        .message.bot {
            background: white;
            color: #333;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            border: 1px solid #eaeaea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .message.user {
            background: #20409a;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
            box-shadow: 0 2px 8px rgba(32, 64, 154, 0.2);
        }
        .message.system {
            background: #fff8e1;
            color: #333;
            align-self: center;
            text-align: center;
            font-size: 13px;
            font-style: italic;
            border-radius: 10px;
            padding: 10px 15px;
            border: 1px solid #ffecb3;
            max-width: 90%;
        }
        .message-time {
            font-size: 11px;
            opacity: 0.6;
            margin-top: 4px;
            text-align: right;
        }
        .chat-footer {
            padding: 15px;
            border-top: 1px solid #eee;
            background: white;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .chat-footer input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
        }
        .chat-footer input:focus {
            border-color: #20409a;
            box-shadow: 0 0 0 2px rgba(32, 64, 154, 0.1);
        }
        .chat-footer button {
            background: #20409a;
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .chat-footer button:hover {
            background: #1a357f;
            transform: scale(1.05);
        }
        .chat-footer button i {
            font-size: 18px;
        }
        .chat-footer button.attachment-btn {
            background: #f0f0f0;
            color: #555;
        }
        .chat-footer button.attachment-btn:hover {
            background: #20409a;
            color: white;
        }
        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 12px 16px;
            background: white;
            border-radius: 18px;
            border: 1px solid #eaeaea;
            width: fit-content;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #20409a;
            border-radius: 50%;
            opacity: 0.6;
            animation: typing 1.4s infinite;
        }
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        .session-info {
            font-size: 11px;
            color: #666;
            text-align: center;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .session-info span {
            font-weight: 600;
            color: #20409a;
        }
        .session-timer {
            font-size: 10px;
            color: #ff4444;
            font-weight: 600;
        }
        /* Mobile Responsive Styles - FIXED HAMBURGER MENU */
        @media (max-width: 768px) {
            .header-content {
                min-height: 55px;
                padding: 5px 0;
                position: relative;
            }
            .logo {
                height: 35px;
            }
            .hamburger {
                display: flex;
                position: relative;
                z-index: 1002;
            }
            nav {
                position: static;
                margin: 0;
            }
            .nav-menu {
                position: fixed;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100vh;
                background-color: white;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding-top: 80px;
                gap: 30px;
                transition: left 0.3s ease;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                z-index: 1001;
            }
            .nav-menu.active {
                left: 0;
            }
            .nav-menu a {
                font-size: 18px;
                padding: 10px 0;
                text-transform: capitalize;
            }
            .hero-section {
                height: 70vh;
            }
            .hero-overlay {
                padding-left: 5%;
                padding-right: 5%;
                justify-content: flex-start;
                align-items: center;
                background: linear-gradient(to right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.3));
            }
            .animated-text {
                text-align: left;
                max-width: 90%;
            }
            .text-line {
                font-size: 1.8rem;
                margin-bottom: 10px;
                text-align: left;
            }
            .text-line:nth-child(2),
            .text-line:nth-child(3),
            .text-line:nth-child(4) {
                font-size: 1.2rem;
                text-align: left;
            }
            .hero-cta {
                animation-delay: 6s;
            }
            .cta-button {
                padding: 10px 28px;
                font-size: 0.95rem;
                min-width: 160px;
                border-radius: 8px;
            }
            .content-section h1 {
                font-size: 1.8rem;
                padding: 0 20px;
            }
            .content-section p {
                font-size: 1rem;
                padding: 0 20px;
                text-align: center;
            }
            .gradient-corner-right,
            .gradient-corner-left {
                width: 200px;
                height: 200px;
            }
            .cookie-consent {
                padding: 15px;
            }
            .cookie-content {
                flex-direction: column;
                text-align: center;
            }
            .cookie-text {
                min-width: 100%;
                margin-bottom: 15px;
            }
            .cookie-buttons {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            .cookie-btn {
                padding: 8px 20px;
                font-size: 13px;
            }
            .chat-icon {
                width: 50px;
                height: 50px;
                bottom: 20px;
                right: 20px;
            }
            .chat-icon i {
                font-size: 20px;
            }
            .chat-tooltip {
                font-size: 12px;
                padding: 8px 12px;
                bottom: 60px;
            }
        }
        /* Hamburger Menu - FIXED */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            width: 30px;
            height: 20px;
            justify-content: space-between;
            background: transparent;
            border: none;
            padding: 0;
            position: relative;
            z-index: 1002;
        }
        .hamburger span {
            display: block;
            height: 3px;
            width: 100%;
            background-color: #333;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        .hamburger.active span:nth-child(1) {
            transform: translateY(8.5px) rotate(45deg);
        }
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        .hamburger.active span:nth-child(3) {
            transform: translateY(-8.5px) rotate(-45deg);
        }
        /* Only show hamburger on mobile */
        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }
            .nav-menu {
                display: none;
            }
            .nav-menu.active {
                display: flex;
            }
        }
        @media (min-width: 769px) {
            .hamburger {
                display: none;
            }
            nav {
                margin: 0 auto;
            }
        }
        @media (max-width: 480px) {
            .header-content {
                min-height: 50px;
            }
            .logo {
                height: 30px;
            }
            .nav-menu {
                top: 0;
                height: 100vh;
            }
            .hero-section {
                height: 60vh;
            }
            .text-line {
                font-size: 1.5rem;
                text-align: left;
            }
            .text-line:nth-child(2),
            .text-line:nth-child(3),
            .text-line:nth-child(4) {
                font-size: 1rem;
                text-align: left;
            }
            .cta-button {
                padding: 9px 24px;
                font-size: 0.9rem;
                min-width: 140px;
                border-radius: 8px;
            }
            .content-section h1 {
                font-size: 1.6rem;
            }
            .content-section p {
                font-size: 0.95rem;
                text-align: center;
            }
            .gradient-corner-right,
            .gradient-corner-left {
                width: 150px;
                height: 150px;
            }
            .cookie-buttons {
                flex-direction: column;
                width: 100%;
            }
            .cookie-btn {
                width: 100%;
            }
            .chat-icon {
                width: 45px;
                height: 45px;
                bottom: 15px;
                right: 15px;
            }
            .chat-icon i {
                font-size: 18px;
            }
            .chat-tooltip {
                font-size: 11px;
                padding: 6px 10px;
                bottom: 55px;
                white-space: normal;
                width: 120px;
                right: -30px;
            }
        }
        /* Confirmation Modal */
        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1003;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .confirmation-modal.show {
            display: flex;
            opacity: 1;
        }
        .confirmation-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
            text-align: center;
            transform: scale(0.9);
            animation: modalPop 0.3s ease forwards;
            max-width: 400px;
            width: 90%;
        }
        @keyframes modalPop {
            to { transform: scale(1); }
        }
        .confirmation-content h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
        }
        .confirmation-content p {
            margin: 0 0 25px 0;
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        .confirmation-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .confirmation-btn {
            padding: 10px 24px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            min-width: 100px;
        }
        .confirmation-btn.cancel {
            background: #f0f0f0;
            color: #555;
        }
        .confirmation-btn.cancel:hover {
            background: #e0e0e0;
        }
        .confirmation-btn.confirm {
            background: #ff4444;
            color: white;
        }
        .confirmation-btn.confirm:hover {
            background: #cc3333;
            transform: translateY(-2px);
        }
        /* Loading animation */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #20409a;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* PDF Preview */
        .pdf-preview {
            max-width: 85%;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 1px solid #eaeaea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .pdf-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .pdf-icon {
            color: #e74c3c;
            font-size: 24px;
        }
        .pdf-details h4 {
            margin: 0 0 5px 0;
            color: #333;
        }
        .pdf-details p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }
        .cv-summary {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            line-height: 1.5;
        }
        .cv-summary h5 {
            margin: 0 0 8px 0;
            color: #20409a;
        }
        /* CV Analysis Styling */
        .cv-analysis {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #eaeaea;
        }
        .analysis-section {
            margin-bottom: 15px;
        }
        .analysis-section h4 {
            color: #20409a;
            margin-bottom: 8px;
            font-size: 16px;
        }
        .analysis-section ul {
            padding-left: 20px;
            margin: 0;
        }
        .analysis-section li {
            margin-bottom: 5px;
        }
        .program-recommendation {
            background: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #20409a;
        }
        .program-recommendation h4 {
            color: #20409a;
            margin-bottom: 10px;
        }
        .recommendation-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .recommendation-table th {
            background: #20409a;
            color: white;
            padding: 8px;
            text-align: left;
            font-size: 13px;
        }
        .recommendation-table td {
            padding: 10px;
            border: 1px solid #eaeaea;
            font-size: 13px;
            vertical-align: top;
        }
        .recommendation-table tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <!-- Header with Logo and Navigation -->
    <header>
        <div class="container">
            <div class="header-content">
                <!-- Logo -->
                <div class="logo-container">
                    <a href="#">
                        <img src="logo2.png" alt="GIBS AI PathFinder Logo" class="logo">
                    </a>
                </div>
                <!-- Navigation - Centered -->
                <nav>
                    <ul class="nav-menu">
                        <li><a href="#home">Home</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#gibs-ai">GIBS-AI</a></li>
                    </ul>
                </nav>
                <!-- Hamburger Menu -->
                <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>
    <!-- Main Content -->
    <main>
        <!-- Full-screen Image Section with Animated Text -->
        <section class="hero-section" id="home">
            <img src="section1.jpg" alt="GIBS Campus or Business Education" class="hero-image">
            <div class="hero-overlay">
                <div class="animated-text">
                    <div class="text-line">Welcome to GIBS AI PathFinder</div>
                    <div class="text-line">Your intelligent guide to discovering the perfect educational path</div>
                    <div class="text-line">at the Gordon Institute of Business Science</div>
                    <div class="text-line">Get personalized study and career recommendations powered by AI</div>
                    <div class="hero-cta">
                        <button onclick="openAIChat()" class="cta-button">Start Your Journey</button>
                    </div>
                </div>
            </div>
        </section>
        <!-- About Section -->
        <section class="content-section" id="about">
            <div class="gradient-corner-right"></div>
            <div class="container section-content">
                <h1>About GIBS<span class="colored-dot">.</span></h1>
                <p>The <span class="gibs-acronym">Gordon Institute of Business Science (GIBS)</span> is the business school of the University of Pretoria, dedicated to excellence in business education, leadership development, and thought leadership in Africa and beyond.</p>
                <p>Our programs are designed to equip professionals with the skills and knowledge needed to thrive in today's dynamic business environment.</p>
            </div>
        </section>
        <!-- GIBS-AI Section -->
        <section class="content-section" id="gibs-ai">
            <div class="gradient-corner-left"></div>
            <div class="container section-content">
                <h1>GIBS AI PathFinder<span class="colored-dot">.</span></h1>
                <p>Experience our intelligent advisor that helps you find the perfect <span class="gibs-acronym">GIBS</span> program based on your career goals, experience, and aspirations. Upload your CV for personalized recommendations.</p>
                <button class="cta-button" onclick="openAIChat()">Try AI Advisor</button>
            </div>
        </section>
    </main>
    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2025 GIBS AI PathFinder. All rights reserved.</p>
            <p>Gordon Institute of Business Science, University of Pretoria</p>
        </div>
    </footer>
    <!-- Cookie Consent Banner -->
    <div class="cookie-consent" id="cookieConsent">
        <div class="cookie-content">
            <div class="cookie-text">
                <p>We use cookies to enhance your experience and track website sessions. By clicking "Accept", you consent to our use of cookies.</p>
            </div>
            <div class="cookie-buttons">
                <button class="cookie-btn decline" onclick="declineCookies()">Decline</button>
                <button class="cookie-btn accept" onclick="acceptCookies()">Accept</button>
            </div>
        </div>
    </div>
    <!-- Floating Chat Icon -->
    <div class="chat-icon" onclick="openAIChat()">
        <i class="fas fa-robot"></i>
        <div class="chat-tooltip">AI Assistant Ready</div>
    </div>
    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="confirmation-modal">
        <div class="confirmation-content">
            <h3>Clear Conversation</h3>
            <p>Are you sure you want to clear all messages and start a new conversation?</p>
            <div class="confirmation-buttons">
                <button class="confirmation-btn cancel" onclick="closeConfirmationModal()">Cancel</button>
                <button class="confirmation-btn confirm" onclick="confirmClearChat()">Clear</button>
            </div>
        </div>
    </div>
    <!-- Chat Modal -->
    <div id="chatModal" class="chat-modal">
        <div class="chat-header">
            <div class="chat-header-left">
                <div class="chat-profile">
                    <i class="fas fa-robot"></i>
                </div>
                <h2>GIBS AI Assistant</h2>
            </div>
            <div>
                <button class="delete-chat" onclick="showClearConfirmation()" title="Clear chat">
                    <i class="fas fa-trash-alt"></i>
                </button>
                <button class="close-chat" onclick="closeChatModal()">&times;</button>
            </div>
        </div>
        <div class="chat-body" id="chatBody">
            <!-- Messages will be loaded here -->
        </div>
        <div class="chat-footer">
            <div class="session-info">
                <div>
                    <span id="messageCount">No messages yet</span>
                </div>
                <div class="session-timer" id="sessionTimer">15:00</div>
            </div>
            <div class="input-container">
                <input type="text" id="chatInput" placeholder="Ask about GIBS programs or upload CV..." onkeypress="handleKeyPress(event)">
                <button class="attachment-btn" onclick="openFileUpload()" title="Attach file (PDF only, max 5MB)">
                    <i class="fas fa-paperclip"></i>
                </button>
                <button onclick="sendMessage()" id="sendBtn" title="Send message">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
    <!-- Hidden File Input -->
    <input type="file" id="fileUpload" style="display:none" accept=".pdf">
    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const NUM_API_KEYS = 3;
        let currentApiKeyIndex = 0;
       
        // AI Model Configuration
        const AI_MODELS = {
            REASONING: {
                primary: 'openai/gpt-oss-120b',
                fallbacks: ['openai/gpt-oss-20b', 'qwen/qwen3-32b']
            },
            FUNCTION_CALLING: {
                primary: 'openai/gpt-oss-120b',
                fallbacks: ['openai/gpt-oss-20b', 'meta-llama/llama-4-scout-17b-16e-instruct', 'qwen/qwen3-32b', 'moonshotai/kimi-k2-instruct-0905']
            },
            REAL_TIME_DATA: {
                primary: 'meta-llama/llama-4-scout-17b-16e-instruct',
                fallbacks: ['openai/gpt-oss-120b']
            },
            GENERAL: {
                primary: 'openai/gpt-oss-120b',
                fallbacks: ['qwen/qwen3-32b']
            }
        };
       
        // File upload constraints
        const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB
        const ALLOWED_FILE_TYPES = ['application/pdf'];
       
        // GIBS Data - Will be loaded from gibs.json
        let gibsData = null;
       
        // Session Management
        let currentSession = {
            id: generateSessionId(),
            messages: [],
            profile: null,
            timestamp: new Date().toISOString(),
            lastActivity: Date.now(),
            cvAnalysis: null,
            userBackground: {},
            uploadedCV: null
        };
       
        let conversationHistory = [];
        let isProcessing = false;
        let sessionTimer = null;
        let timeLeft = 15 * 60; // 15 minutes in seconds
        let uploadInProgress = false;
        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', async function() {
            await loadGibsData();
            initSession();
            setupHamburgerMenu();
            setupCookieConsent();
            setupChatFunctionality();
            setupSmoothScrolling();
            startSessionTimer();
        });
        // ============================================
        // LOAD GIBS DATA from gibs.json file
        // ============================================
        async function loadGibsData() {
            try {
                // Try to load from gibs.json file
                const response = await fetch('gibbs.json');
                if (response.ok) {
                    gibsData = await response.json();
                    console.log("GIBS data loaded successfully from gibs.json");
                } else {
                    // Fallback to embedded data
                    gibsData = getDefaultGibsData();
                    console.log("Using embedded GIBS data");
                }
            } catch (error) {
                console.error("Error loading GIBS data:", error);
                gibsData = getDefaultGibsData();
            }
        }
        function getDefaultGibsData() {
            return {
                "institution": {
                    "name": "Gordon Institute of Business Science",
                    "acronym": "GIBS",
                    "university": "University of Pretoria",
                    "location": "Illovo, Johannesburg, South Africa",
                    "accreditation": ["AACSB", "AMBA", "EQUIS"],
                    "description": "GIBS is a leading business school in Africa, focusing on business leadership and development on the continent.",
                    "mission": "To build sustainable businesses and societies in Africa and beyond through excellence in business and leadership education."
                },
                "programs": [
                    {
                        "name": "Programme for Management Development (PMD)",
                        "duration": "10 months",
                        "level": "NQF 7",
                        "cost": "R 98,293",
                        "requirements": "Matric certificate, 5-10 years work experience",
                        "description": "Foundation program for experienced managers without formal business education"
                    },
                    {
                        "name": "Advanced Diploma in General Management",
                        "duration": "10 months",
                        "level": "NQF 8",
                        "cost": "R 113,715",
                        "requirements": "Degree (NQF 7), 2 years work experience",
                        "description": "For graduates seeking management skills development"
                    },
                    {
                        "name": "Postgraduate Diploma in Business Administration (PDBA)",
                        "duration": "10-11 months",
                        "level": "NQF 8",
                        "cost": "R 150,777",
                        "requirements": "Degree/Honours (NQF 7), 5 years work experience, 2 years managerial",
                        "description": "Comprehensive business education for career advancement"
                    },
                    {
                        "name": "Master of Business Administration (MBA)",
                        "duration": "Various formats (1-2 years)",
                        "level": "NQF 9",
                        "cost": "R 240,278 - R 334,223",
                        "requirements": "Honours/Post Grad (NQF 8), 5 years work experience",
                        "description": "Flagship program for executive leadership development"
                    },
                    {
                        "name": "MPhil (Corporate Strategy/Change Leadership)",
                        "duration": "18 months",
                        "level": "NQF 9",
                        "cost": "R 240,278",
                        "requirements": "Master's degree, 20 page research proposal, 5 years work experience",
                        "description": "Research-focused program for specialized consulting or academia"
                    }
                ],
                "key_focus_areas": [
                    "African business leadership",
                    "Entrepreneurship and innovation",
                    "Ethical leadership",
                    "Sustainable business practices",
                    "Digital transformation"
                ]
            };
        }
        // ============================================
        // SESSION MANAGEMENT
        // ============================================
        function initSession() {
            try {
                const savedSession = localStorage.getItem('gibs_session');
                if (savedSession) {
                    const parsed = JSON.parse(savedSession);
                    currentSession = {
                        ...currentSession,
                        ...parsed,
                        messages: parsed.messages || [],
                        cvAnalysis: parsed.cvAnalysis || null,
                        userBackground: parsed.userBackground || {},
                        uploadedCV: parsed.uploadedCV || null
                    };
                   
                    currentSession.messages.forEach(msg => {
                        addMessageToChat(msg.role, msg.content, false);
                        conversationHistory.push(msg);
                    });
                   
                    if (currentSession.cvAnalysis) {
                        console.log("Loaded CV analysis from session");
                    }
                }
            } catch (e) {
                console.log('Starting fresh session');
            }
            updateSessionInfo();
        }
        function generateSessionId() {
            return 'gibs_' + Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }
        function saveSession() {
            try {
                if (currentSession.messages.length > 20) {
                    currentSession.messages = currentSession.messages.slice(-20);
                }
                currentSession.lastActivity = Date.now();
                localStorage.setItem('gibs_session', JSON.stringify(currentSession));
            } catch (e) {
                console.log('Error saving session');
            }
        }
        function updateSessionInfo() {
            const messageCount = currentSession.messages.length;
            let messageText = "No messages yet";
           
            if (messageCount === 1) {
                messageText = "1 message";
            } else if (messageCount > 1) {
                messageText = `${messageCount} messages`;
            }
           
            document.getElementById('messageCount').textContent = messageText;
        }
        function resetTimer() {
            timeLeft = 15 * 60;
            updateTimerDisplay();
            startSessionTimer();
        }
        function startSessionTimer() {
            if (sessionTimer) clearInterval(sessionTimer);
           
            sessionTimer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
               
                if (timeLeft <= 0) {
                    clearInterval(sessionTimer);
                    resetSession();
                    addSystemMessage("Your session has expired. Starting a fresh conversation.");
                }
            }, 1000);
        }
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('sessionTimer').textContent =
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
           
            // Color coding
            if (timeLeft < 60) {
                document.getElementById('sessionTimer').style.color = '#ff4444';
            } else if (timeLeft < 300) {
                document.getElementById('sessionTimer').style.color = '#ffaa00';
            } else {
                document.getElementById('sessionTimer').style.color = '#20409a';
            }
        }
        function resetSession() {
            currentSession = {
                id: generateSessionId(),
                messages: [],
                profile: null,
                timestamp: new Date().toISOString(),
                lastActivity: Date.now(),
                cvAnalysis: null,
                userBackground: {},
                uploadedCV: null
            };
            conversationHistory = [];
            document.getElementById('chatBody').innerHTML = '';
            updateSessionInfo();
            resetTimer();
            localStorage.removeItem('gibs_session');
           
            // Show welcome message
            setTimeout(() => {
                addBotMessage("Hello! I'm your GIBS AI PathFinder Assistant. I can help you explore programs, admissions, and career opportunities at GIBS. How can I assist you today?");
            }, 500);
        }
        // ============================================
        // MODAL FUNCTIONS
        // ============================================
        function showClearConfirmation() {
            document.getElementById('confirmationModal').classList.add('show');
        }
        function closeConfirmationModal() {
            document.getElementById('confirmationModal').classList.remove('show');
        }
        function confirmClearChat() {
            closeConfirmationModal();
            resetSession();
        }
        // ============================================
        // API PROXY HELPER
        // ============================================
        async function groqApiCall(body) {
            let retries = 0;
            while (retries < NUM_API_KEYS) {
                try {
                    const response = await fetch(`/api/groq?keyIndex=${currentApiKeyIndex}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(body)
                    });

                    if (response.ok) {
                        return await response.json();
                    } else if (response.status === 429 || response.status === 401) {
                        currentApiKeyIndex = (currentApiKeyIndex + 1) % NUM_API_KEYS;
                        retries++;
                        continue;
                    } else {
                        throw new Error(`API error: ${response.status}`);
                    }
                } catch (e) {
                    currentApiKeyIndex = (currentApiKeyIndex + 1) % NUM_API_KEYS;
                    retries++;
                    if (retries >= NUM_API_KEYS) {
                        throw e;
                    }
                }
            }
            throw new Error('Max retries exceeded for API keys');
        }
        // ============================================
        // FILE UPLOAD & PDF PROCESSING
        // ============================================
        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            // Validate file type
            if (!ALLOWED_FILE_TYPES.includes(file.type)) {
                addSystemMessage(`Please upload only PDF files. You uploaded: ${file.type || 'unknown type'}`);
                event.target.value = '';
                return;
            }
            // Validate file size
            if (file.size > MAX_FILE_SIZE) {
                addSystemMessage(`File is too large. Maximum size is 5MB. Your file: ${(file.size / 1024 / 1024).toFixed(2)}MB`);
                event.target.value = '';
                return;
            }
            // Show file attached message immediately
            showFileAttached(file);
           
            try {
                // Process in background
                uploadInProgress = true;
               
                // Extract text from PDF using PDF.js
                const text = await extractTextFromPDF(file);
               
                // Analyze CV with AI
                const analysis = await analyzeCVWithAI(text);
               
                // Save CV analysis to session
                currentSession.cvAnalysis = analysis;
                currentSession.uploadedCV = {
                    name: file.name,
                    size: file.size,
                    lastModified: file.lastModified,
                    textPreview: text.substring(0, 500) + '...'
                };
               
                // Extract user background info
                extractBackgroundFromAnalysis(analysis);
               
                // Show analysis results
                showCVAnalysis(analysis, file.name);
               
                saveSession();
               
            } catch (error) {
                console.error("CV processing error:", error);
                addSystemMessage(`Error processing CV. Please try again or describe your background manually.`);
            } finally {
                uploadInProgress = false;
                event.target.value = '';
            }
        }
        function showFileAttached(file) {
            const chatBody = document.getElementById('chatBody');
            const fileDiv = document.createElement('div');
            fileDiv.className = 'message user pdf-preview';
           
            fileDiv.innerHTML = `
                <div class="pdf-info">
                    <i class="fas fa-file-pdf pdf-icon"></i>
                    <div class="pdf-details">
                        <h4> ${file.name}</h4>
                        <p>CV attached - ${(file.size / 1024).toFixed(0)}KB</p>
                    </div>
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: #666;">
                    <i class="fas fa-spinner fa-spin"></i> Analyzing your CV...
                </div>
                <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
            `;
           
            chatBody.appendChild(fileDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
        }
        async function extractTextFromPDF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
               
                reader.onload = async function(e) {
                    try {
                        const typedarray = new Uint8Array(e.target.result);
                       
                        // Load PDF using PDF.js
                        const loadingTask = pdfjsLib.getDocument(typedarray);
                        const pdf = await loadingTask.promise;
                       
                        let fullText = '';
                       
                        // Extract text from each page
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            const pageText = textContent.items.map(item => item.str).join(' ');
                            fullText += pageText + '\n\n';
                           
                            // Limit to first 5 pages for performance
                            if (i >= 5) break;
                        }
                       
                        if (!fullText.trim()) {
                            throw new Error("Could not extract text from PDF. The PDF might be scanned or image-based.");
                        }
                       
                        resolve(fullText);
                       
                    } catch (error) {
                        console.error("PDF extraction error:", error);
                        reject(new Error("Failed to read PDF content. Please ensure it's a text-based PDF."));
                    }
                };
               
                reader.onerror = () => reject(new Error("Failed to read file"));
                reader.readAsArrayBuffer(file);
            });
        }
        async function analyzeCVWithAI(cvText) {
            // Create a complete, well-structured prompt
            const context = `You are analyzing a CV for GIBS program recommendations.
CRITICAL FORMATTING INSTRUCTIONS:
1. Use natural human language - no asterisks, no markdown
2. Use proper spacing, new lines, and bullet points
3. Write complete sentences with proper grammar
4. Structure your response with clear sections
5. Make it conversational and professional
CV TEXT (first 8000 characters):
${cvText.substring(0, 8000)}
GIBS PROGRAMS INFORMATION:
${JSON.stringify(gibsData.programs, null, 2)}
RESPONSE STRUCTURE:
1. Start with a warm, personalized greeting using the person's name if found
2. Show understanding of their specific background
3. Highlight key qualifications and experiences
4. Provide well-structured program recommendations
5. Use tables or clear formatting for comparison
6. End with an encouraging note and next steps
EXAMPLE RESPONSE STRUCTURE:
Hey [Name]! Thanks for sharing your CV.
I've reviewed your background and here's what I'm seeing:
What stands out:
 Your [degree] in [field] from [university]
 [X] years of experience in [industry/role]
 Key projects: [mention specific projects]
 Technical skills: [list key skills]
Which GIBS programme fits you best right now?
[Programme 1]
Why it matches you:
 Point 1
 Point 2
 Point 3
What you'll gain:
 Benefit 1
 Benefit 2
 Benefit 3
[Programme 2 - if applicable]
Why it could work:
 Point 1
 Point 2
Next steps:
Based on your background, I'd recommend [specific program]. Would you like me to tell you more about the admission requirements or help you explore other options?`;
            try {
                const data = await groqApiCall({
                    model: 'openai/gpt-oss-120b',
                    messages: [
                        {
                            role: 'system',
                            content: context
                        },
                        {
                            role: 'user',
                            content: 'Please analyze this CV and provide GIBS program recommendations in a complete, well-structured response.'
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 1200,
                    top_p: 0.95
                });
                let responseText = data.choices[0].message.content;
               
                // Clean up the response - remove asterisks and ensure complete sentences
                responseText = responseText.replace(/\*\*/g, '');
                responseText = responseText.replace(/\*/g, '');
               
                // Ensure response ends with proper punctuation
                if (!responseText.match(/[.!?]$/)) {
                    responseText += '.';
                }
               
                return responseText;
            } catch (error) {
                console.error('CV analysis error:', error);
                return "Thanks for uploading your CV! I can see you have relevant experience. Could you tell me more about your career goals and background so I can suggest the best GIBS programs for you?";
            }
        }
        function showCVAnalysis(analysis, fileName) {
            // Remove the "Analyzing..." message
            const chatBody = document.getElementById('chatBody');
            const lastMessage = chatBody.lastChild;
            if (lastMessage && lastMessage.textContent.includes('Analyzing')) {
                chatBody.removeChild(lastMessage);
            }
           
            // Show the analysis
            addBotMessage(analysis);
           
            // Add to conversation history
            const analysisMsg = {
                role: 'assistant',
                content: analysis,
                timestamp: new Date().toISOString()
            };
            conversationHistory.push(analysisMsg);
            currentSession.messages.push(analysisMsg);
           
            saveSession();
            updateSessionInfo();
        }
        function extractBackgroundFromAnalysis(analysis) {
            // Simple extraction of key information for future reference
            const lowerAnalysis = analysis.toLowerCase();
           
            if (lowerAnalysis.includes("degree") || lowerAnalysis.includes("bachelor") || lowerAnalysis.includes("master") || lowerAnalysis.includes("diploma")) {
                currentSession.userBackground.hasDegree = true;
            }
           
            if (lowerAnalysis.includes("year") && lowerAnalysis.includes("experience")) {
                // Try to extract years
                const yearMatch = analysis.match(/(\d+)\s*years?/i);
                if (yearMatch) {
                    currentSession.userBackground.yearsExperience = parseInt(yearMatch[1]);
                }
            }
           
            if (lowerAnalysis.includes("manager") || lowerAnalysis.includes("leadership") || lowerAnalysis.includes("team lead")) {
                currentSession.userBackground.hasManagementExperience = true;
            }
           
            if (lowerAnalysis.includes("computer science") || lowerAnalysis.includes("software") || lowerAnalysis.includes("developer")) {
                currentSession.userBackground.techBackground = true;
            }
           
            saveSession();
        }
        // ============================================
        // CHAT FUNCTIONALITY
        // ============================================
        function setupChatFunctionality() {
            document.getElementById('fileUpload').addEventListener('change', handleFileUpload);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }
        function openAIChat() {
            const modal = document.getElementById('chatModal');
            modal.style.display = 'flex';
           
            if (currentSession.messages.length === 0) {
                setTimeout(() => {
                    addBotMessage("Hello! I'm your GIBS AI PathFinder Assistant. I can help you explore programs, admissions, and career opportunities at GIBS. How can I assist you today?");
                }, 300);
            }
        }
        function closeChatModal() {
            document.getElementById('chatModal').style.display = 'none';
        }
        function openFileUpload() {
            document.getElementById('fileUpload').click();
        }
        async function sendMessage() {
            if (isProcessing || uploadInProgress) return;
           
            const input = document.getElementById('chatInput');
            const userMessage = input.value.trim();
           
            if (!userMessage) return;
           
            addUserMessage(userMessage);
            input.value = '';
           
            const userMsg = { role: 'user', content: userMessage, timestamp: new Date().toISOString() };
            conversationHistory.push(userMsg);
            currentSession.messages.push(userMsg);
           
            // Reset timer on user activity
            resetTimer();
           
            await processWithAI(userMessage);
           
            saveSession();
            updateSessionInfo();
        }
        async function processWithAI(userMessage) {
            isProcessing = true;
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.innerHTML = '<div class="loader"></div>';
            sendBtn.disabled = true;
           
            const typingMsg = addTypingIndicator();
           
            try {
                const modelType = determineModelType(userMessage);
                const context = buildAIContext();
                let response = await callAIAPI(userMessage, context, modelType);
               
                // Validate and clean the response
                response = validateResponse(response);
               
                typingMsg.remove();
                addBotMessage(response);
               
                const botMsg = { role: 'assistant', content: response, timestamp: new Date().toISOString() };
                conversationHistory.push(botMsg);
                currentSession.messages.push(botMsg);
               
            } catch (error) {
                console.error('AI Error:', error);
                typingMsg.remove();
                addBotMessage("I apologize, I'm having some technical difficulties. Could you please rephrase your question or try again in a moment?");
            } finally {
                isProcessing = false;
                sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                sendBtn.disabled = false;
            }
        }
        function validateResponse(response) {
            // Clean up common issues
            let cleaned = response;
           
            // Remove asterisks
            cleaned = cleaned.replace(/\*\*/g, '');
            cleaned = cleaned.replace(/\*/g, '');
           
            // Ensure complete sentences
            if (!cleaned.match(/[.!?]$/)) {
                cleaned += '.';
            }
           
            // Check for truncated responses and fix them
            const sentences = cleaned.split(/[.!?]+/);
            if (sentences.length > 1) {
                // Take all complete sentences
                cleaned = sentences.slice(0, -1).map(s => s.trim()).join('. ') + '.';
            }
           
            return cleaned;
        }
        function determineModelType(query) {
            const queryLower = query.toLowerCase();
           
            if (queryLower.includes('compare') ||
                queryLower.includes('which is better') ||
                queryLower.includes('should i choose') ||
                queryLower.includes('analysis') ||
                queryLower.includes('recommend') ||
                queryLower.includes('best fit')) {
                return 'REASONING';
            }
           
            if (queryLower.includes('calculate') ||
                queryLower.includes('cost') ||
                queryLower.includes('duration') ||
                queryLower.includes('requirement') ||
                queryLower.includes('deadline') ||
                queryLower.includes('process')) {
                return 'FUNCTION_CALLING';
            }
           
            if (queryLower.includes('current') ||
                queryLower.includes('latest') ||
                queryLower.includes('real-time') ||
                queryLower.includes('market') ||
                queryLower.includes('trend')) {
                return 'REAL_TIME_DATA';
            }
           
            return 'GENERAL';
        }
        function buildAIContext() {
            // Build user background summary
            let backgroundSummary = "User Background Summary:\n";
           
            if (currentSession.userBackground.hasDegree) {
                backgroundSummary += "- Has a degree qualification\n";
            }
           
            if (currentSession.userBackground.yearsExperience) {
                backgroundSummary += `- ${currentSession.userBackground.yearsExperience} years of work experience\n`;
            }
           
            if (currentSession.userBackground.hasManagementExperience) {
                backgroundSummary += "- Has management/leadership experience\n";
            }
           
            if (currentSession.userBackground.techBackground) {
                backgroundSummary += "- Has technology/computer science background\n";
            }
           
            if (Object.keys(currentSession.userBackground).length === 0) {
                backgroundSummary = "No background information available yet.\n";
            }
            let context = `You are the GIBS AI PathFinder Assistant.
CRITICAL RESPONSE RULES:
1. NEVER show internal reasoning or thinking process
2. Provide ONLY final, conversational responses
3. Use natural human language with proper spacing and formatting
4. Write complete sentences with proper grammar
5. Reference the user's background when relevant
6. Structure responses with clear paragraphs and bullet points
7. End responses properly - no truncated sentences
BACKGROUND INFORMATION:
${backgroundSummary}
CV ANALYSIS (if available):
${currentSession.cvAnalysis ? `Previous CV analysis available for reference.` : 'No CV analysis yet'}
GIBS PROGRAMS INFORMATION:
${JSON.stringify(gibsData.programs, null, 2)}
RECENT CONVERSATION (last 3 messages):
${conversationHistory.slice(-3).map(msg => `${msg.role}: ${msg.content}`).join('\n')}
RESPONSE GUIDELINES:
1. If user has a degree: Reference it and suggest appropriate programs like "With your degree in [field], you could consider..."
2. If user has experience: Mention how GIBS programs build on it
3. Structure complex information with tables or clear sections
4. Always use proper spacing and formatting
5. Keep responses complete and well-structured
6. Use bullet points for lists
7. Reference African business context when relevant
8. Ask clarifying questions if more information is needed
EXAMPLE RESPONSE FORMAT:
For someone with a computer science degree:
"With your BSc in Computer Science and your experience in software development, the Advanced Diploma in General Management would be an excellent fit. This program helps technical professionals add business management skills to their existing expertise.
What you'll gain:
 Core business knowledge in finance, marketing, and operations
 Leadership skills for tech teams
 Understanding of digital transformation in African businesses
The program requires a degree and 2 years of experience, which you seem to have based on your background. Would you like me to tell you more about the admission process?"`;
            return context;
        }
        async function callAIAPI(userMessage, context, modelType = 'GENERAL') {
            let modelConfig = AI_MODELS[modelType] || AI_MODELS.GENERAL;
            let modelToUse = modelConfig.primary;
           
            try {
                const data = await groqApiCall({
                    model: modelToUse,
                    messages: [
                        {
                            role: 'system',
                            content: context
                        },
                        {
                            role: 'user',
                            content: userMessage
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 1200,
                    top_p: 0.95
                });
                return data.choices[0].message.content;
            } catch (error) {
                // Try fallback models
                for (let fallbackModel of modelConfig.fallbacks) {
                    try {
                        const data = await groqApiCall({
                            model: fallbackModel,
                            messages: [
                                {
                                    role: 'system',
                                    content: context
                                },
                                {
                                    role: 'user',
                                    content: userMessage
                                }
                            ],
                            temperature: 0.7,
                            max_tokens: 1000
                        });
                        return data.choices[0].message.content;
                    } catch (e) {
                        continue;
                    }
                }
                throw error;
            }
        }
        // ============================================
        // UI FUNCTIONS
        // ============================================
        function addUserMessage(text) {
            addMessageToChat('user', text);
        }
        function addBotMessage(text) {
            addMessageToChat('bot', text);
        }
        function addSystemMessage(text) {
            addMessageToChat('system', text);
        }
        function addMessageToChat(role, text, scroll = true) {
            const chatBody = document.getElementById('chatBody');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
           
            // Format text properly
            let formattedText = text
                .replace(/\n\n/g, '<br><br>')
                .replace(/\n/g, '<br>')
                .replace(//g, '');
           
            messageDiv.innerHTML = formattedText;
           
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            messageDiv.appendChild(timeDiv);
           
            chatBody.appendChild(messageDiv);
           
            if (scroll) {
                setTimeout(() => {
                    chatBody.scrollTop = chatBody.scrollHeight;
                }, 100);
            }
        }
        function addTypingIndicator() {
            const chatBody = document.getElementById('chatBody');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatBody.appendChild(typingDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
            return typingDiv;
        }
        // ============================================
        // OTHER FUNCTIONS
        // ============================================
        function setupHamburgerMenu() {
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.querySelector('.nav-menu');
           
            if (!hamburger || !navMenu) return;
           
            hamburger.addEventListener('click', function(e) {
                e.stopPropagation();
                this.classList.toggle('active');
                navMenu.classList.toggle('active');
            });
           
            document.querySelectorAll('.nav-menu a').forEach(link => {
                link.addEventListener('click', function() {
                    hamburger.classList.remove('active');
                    navMenu.classList.remove('active');
                });
            });
           
            document.addEventListener('click', function(e) {
                if (!hamburger.contains(e.target) && !navMenu.contains(e.target)) {
                    hamburger.classList.remove('active');
                    navMenu.classList.remove('active');
                }
            });
        }
        function setupSmoothScrolling() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                   
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        e.preventDefault();
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        }
        function setupCookieConsent() {
            const cookieConsent = document.getElementById('cookieConsent');
            const cookieChoice = getCookie('gibs_cookie_consent');
           
            if (!cookieChoice) {
                setTimeout(() => {
                    cookieConsent.classList.add('show');
                }, 2000);
            }
        }
        function setCookie(name, value, days) {
            const d = new Date();
            d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = "expires=" + d.toUTCString();
            document.cookie = name + "=" + value + ";" + expires + ";path=/;SameSite=Lax";
        }
        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
        function acceptCookies() {
            setCookie('gibs_cookie_consent', 'accepted', 365);
            document.getElementById('cookieConsent').classList.remove('show');
        }
        function declineCookies() {
            setCookie('gibs_cookie_consent', 'declined', 30);
            document.getElementById('cookieConsent').classList.remove('show');
        }
        function handleKeyPress(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }
        // ============================================
        // GLOBAL FUNCTIONS
        // ============================================
        window.openAIChat = openAIChat;
        window.closeChatModal = closeChatModal;
        window.sendMessage = sendMessage;
        window.handleKeyPress = handleKeyPress;
        window.acceptCookies = acceptCookies;
        window.declineCookies = declineCookies;
        window.openFileUpload = openFileUpload;
        window.showClearConfirmation = showClearConfirmation;
        window.closeConfirmationModal = closeConfirmationModal;
        window.confirmClearChat = confirmClearChat;
    </script>
</body>
</html>